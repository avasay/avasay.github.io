<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Redirecting...</title>
    <script>
        (function () {
            // Define the base paths for your sub-projects hosted in subdirectories.
            // IMPORTANT: Must end with a slash!
            const subProjectBasePaths = [
                '/MyCalculator/',
                '/ToDoList/',
                '/ImageCompressor/',
                '/ImageUpscaler/'
                // Add other sub-project base paths here
            ];

            const path = window.location.pathname;
            const query = window.location.search;
            const hash = window.location.hash;

            console.log('404 Handler - Path:', path);

            let isSubProject = false;
            for (const basePath of subProjectBasePaths) {
                if (path.toLowerCase().startsWith(basePath.toLowerCase())) {
                    console.log('Sub-project path detected:', path, 'Base:', basePath);
                    // Redirect to the base path of the sub-project.
                    // This ensures the sub-project's index.html (with correct base href) is loaded.
                    // Use replace to avoid adding the 404 redirect to history.
                    const redirectUrl = basePath + query + hash;
                    console.log('Redirecting to sub-project base:', redirectUrl);
                    window.location.replace(redirectUrl);
                    isSubProject = true;
                    break;
                }
            }

            if (!isSubProject) {
                // Not a known sub-project path. Assume it's intended for the root SPA.
                // Redirect to the root, passing the original path via query param 'p'.
                // The root index.html script will handle rewriting the URL.
                const redirectUrl = '/?p=' + encodeURIComponent(path) + query + hash;
                console.log('Redirecting to root with path parameter:', redirectUrl);
                window.location.replace(redirectUrl);
            }
        })();
    </script>
</head>
<body>
    <p>If you are not redirected automatically, please check the URL or return to the <a href="/">homepage</a>.</p>
</body>
</html>
